数据集管理和预处理

原始 3D 数据集包含 DICOM、nrrd 或 mhd 格式的计算机断层扫描 (CT) 和磁共振 (MR) 图像。为了确保一致性以及与开发医学图像深度学习模型的兼容性，我们将图像转换为广泛使用的 NifTI 格式。
此外，灰度图像（例如 X 光和超声波）以及 RGB 图像（包括内窥镜、皮肤镜、眼底和病理图像）均转换为 png 格式。
为了提高数据集的质量和一致性，我们采用了多项专属标准，包括不完整的图像、带有分支结构的分割目标、不准确的注释以及微小体积。
值得注意的是，不同模态下的图像强度差异显著。例如，CT 图像的强度值范围为 -2000 到 2000，而 MR 图像的范围为 0 到 3000。
在内窥镜和超声图像中，强度值通常介于 0 到 255 之间。为了促进稳定的训练，我们对所有图像进行了强度标准化，确保它们具有相同的强度范围。

对于 CT 图像，我们首先使用典型的窗宽和窗位值对亨斯菲尔德单位进行归一化。软组织、肺和脑的窗宽和窗位值分别为 (W:400, L:40)、(W:1500, L:-160) 和 (W:80, L:40)。
随后，将强度值重新缩放至 [0, 255] 范围。对于 MR、X 射线、超声、乳房 X 线摄影和光学相干断层扫描 (OCT) 图像，我们将强度值裁剪至 0.5 到 99.5 百分位数之间的范围，
然后将其重新缩放至 [0, 255] 范围。对于 RGB 图像（例如内窥镜检查、皮肤镜检查、眼底和病理图像），如果它们已经在预期的 [0, 255] 强度范围内，则其强度保持不变。
但是，如果超出此范围，我们会使用最大最小归一化将强度值重新缩放到[0, 255]。最后，为了满足模型的输入要求，所有图像均调整为1024×1024×3的统一大小。
对于全切片病理图像，使用滑动窗口方法提取不重叠的块。位于边界上的块用0填充至此大小。对于3D CT和MRI图像，每个2D切片的大小均调整为1024×1024，并且通道重复三次以保持一致性。
其余2D图像直接调整为1024×1024×3。使用双三次插值调整图像大小，而使用最近邻插值调整蒙版大小，以保持其精确的边界并避免引入不必要的伪影。
这些标准化程序确保了所有图像的一致性和兼容性，并有助于无缝集成到模型训练和评估流程的后续阶段。

supplementary: https://static-content.springer.com/esm/art%3A10.1038%2Fs41467-024-44824-z/MediaObjects/41467_2024_44824_MOESM1_ESM.pdf
